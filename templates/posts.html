{% extends "base.html" %}

{% block content %}
<div class="posts-page">
    <div class="page-header">
        <a href="{{ url_for('index') }}" class="btn btn-secondary">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
        <h1>üìã –í—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h1>
    </div>

    <div class="filters">
        <h3>–§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:</h3>
        <div class="categories-filter">
            <a href="{{ url_for('posts') }}" class="category-btn {% if not request.args.get('category') %}active{% endif %}">–í—Å–µ</a>
            {% for value, label in categories %}
                <a href="{{ url_for('posts', category=value) }}" class="category-btn {% if request.args.get('category') == value %}active{% endif %}">
                    {{ label }}
                </a>
            {% endfor %}
        </div>
    </div>

    <div class="posts-list">
        {% for post in posts.items %}
            <div class="post-card">
                <h3><a href="{{ url_for('post_detail', post_id=post.id) }}">{{ post.title }}</a></h3>
                <p class="post-meta">
                    üìç {{ post.category }} ‚Ä¢ {{ post.created_at.strftime('%d.%m.%Y') }}
                    {% if post.price %} ‚Ä¢ üí∞ {{ post.price }}{% endif %}
                </p>
                <p>{{ post.content[:150] }}{% if post.content|length > 150 %}...{% endif %}</p>
                <a href="{{ url_for('post_detail', post_id=post.id) }}" class="read-more">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
            </div>
        {% else %}
            <div class="no-posts">
                <p>–û–±—ä—è–≤–ª–µ–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç.</p>
                <a href="{{ url_for('create_post') }}" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</a>
            </div>
        {% endfor %}
    </div>

    {% if posts.pages > 1 %}
    <div class="pagination">
        {% if posts.has_prev %}
            <a href="{{ url_for('posts', page=posts.prev_num, category=request.args.get('category', '')) }}" class="btn">‚Üê –ù–∞–∑–∞–¥</a>
        {% endif %}

        <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ posts.page }} –∏–∑ {{ posts.pages }}</span>

        {% if posts.has_next %}
            <a href="{{ url_for('posts', page=posts.next_num, category=request.args.get('category', '')) }}" class="btn">–í–ø–µ—Ä–µ–¥ ‚Üí</a>
        {% endif %}
    </div>
    {% endif %}

    <div class="quick-actions">
        <a href="{{ url_for('create_post') }}" class="btn btn-primary">üìù –î–æ–±–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</a>
        <a href="{{ url_for('index') }}" class="btn btn-secondary">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
    </div>
</div>
{% endblock %}